<!--miniprogram/pages/ingame/ingame.wxml-->

<view class="DrawerPage {{packageName==='package'?'show':''}}">
  <cu-custom bgColor="bg-gradual-blue" isBack="{{true}}">
    <view slot="backText">返回</view>
    <view slot="content">校园探宝·游戏中</view>
  </cu-custom>

  <!-- 提示框 -->
  <view class="cu-bar bg-white">
    <view class="action">
      <text class="cuIcon-title text-blue"></text> 我的位置
    </view>
    <view class="action">
      <text class="cuIcon-title text-red"></text> 已发现的线索
    </view>
  </view>

  <!-- 游戏主地图 -->
  <map
    id="ingame_map"
    longitude="{{game_center.longitude}}"
    latitude="{{game_center.latitude}}"
    scale="17"
    show-location="{{true}}"
    style="width: 100%; height: {{mapHeight}}px;  display:{{showMap?'block':'none'}}"
    bindtap="mapclicked"
  ><!--放弃cover-view方案-->
  </map>
  <!-- 由于map组建层级最高会使得动画不连贯，增加一张替代图片用于平滑抽屉动画效果 -->
  <image 
    src="../../resources/images/map_gause.jpg" 
    mode="scaleToFill" 
    style="width: 100%; height: {{mapHeight}}px; display:{{!showMap?'block':'none'}}"
  ></image>

  <!-- 可操作按钮组 -->
  <view class="bg-white" style="position:absolute;bottom:5rpx;text-align:center;width:100%;">
    <button class="bg-gradual-green cu-btn margin-lr-sm shadow lg" disabled="{{buttonDisabled}}" bindtap='tryDig'>
      <text class="cuIcon-repairfill"></text>　尝试挖掘
    </button>
    
    <button class="bg-gradual-blue cu-btn margin-lr-sm shadow lg" disabled="{{buttonDisabled}}" bindtap="showPackage" data-target="package">
      <text class="cuIcon-list"></text>　我的线索
    </button>
  </view>

</view>

<!--背包抽屉-->
<view class="DrawerClose {{packageName==='package'?'show':''}}" bindtap="hidePackage">
  <text class="cuIcon-pullright"></text>
</view>
<scroll-view scroll-y class="DrawerWindow {{packageName==='package'?'show':''}}">
  <view class="cu-list menu card-menu margin-top-xl margin-bottom-xl shadow-lg">
    <view class="cu-item arrow" wx:for="{{20}}" wx:key="index">
      <view class="content">
        <text class="cuIcon-github text-grey"></text>
        <text class="text-grey">{{index +1}}</text>
      </view>
    </view>
  </view>
</scroll-view>

<!-- 其它非页面组件 -->
<!-- 加载框，当按钮禁用时会出现 -->
<view class='cu-load load-modal' wx:if="{{buttonDisabled}}">
  <!-- <view class='cuIcon-emojifill text-orange'></view> -->
  <image src='../../resources/images/loding.gif' class='gif' mode='aspectFit'></image>
  <view class='gray-mauve'>奋力掘进中...</view>
</view>
<!-- 底部错误提示框 -->
<view class="cu-modal bottom-modal {{errorModalShow?'show':''}}" bindtap="hideBottomErrorModel">
  <view class="cu-dialog" catchtap>
    <view class="padding-xl">
      <text class="text-bold text-red">{{errorMsg}}</text>
    </view>
  </view>
</view>